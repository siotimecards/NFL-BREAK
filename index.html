<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>NFL Break ‚Äì Inscriptions | Siotime</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f4f4f4;
  text-align:center;
}

/* ===== BANDEAU SOCIAL ===== */
#social-bar{
  background:#000;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:25px;
  padding:12px;
  flex-wrap:wrap;
}

.social-item{
  display:flex;
  align-items:center;
  gap:6px;
  font-size:14px;
  white-space:nowrap;
}

.social-item img{
  width:18px;
}

@media(max-width:600px){
  .social-item{ font-size:12px }
  .social-item img{ width:14px }
}

/* ===== TITRES ===== */
h1{ margin:20px 0 10px }
.timer{ color:red; font-weight:bold }

/* ===== COMPTEUR ===== */
#spotsLeft{
  margin:10px;
  font-weight:bold;
  font-size:18px;
}

/* ===== GRID TEAMS ===== */
.teams{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:15px;
  margin:20px;
}

.team{
  width:140px;
  padding:10px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
  cursor:pointer;
  transition:0.2s;
  position:relative;
}

.team:hover{ transform:scale(1.05) }

.team img{ width:70px }

.price{ color:green; font-size:0.9em }

.taken{
  opacity:0.4;
  pointer-events:none;
  background:#ddd;
}

/* FORMULAIRE */
.reserve-form{
  position:absolute;
  inset:0;
  background:rgba(255,255,255,0.95);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:6px;
  border-radius:12px;
  padding:10px;
}

/* ANIMATION */
.reserved{ animation:pop 0.4s ease }
@keyframes pop{
  0%{ transform:scale(1) }
  50%{ transform:scale(1.2) }
  100%{ transform:scale(1) }
}

.last-spot{
  animation:flash 0.6s infinite alternate;
}
@keyframes flash{
  from{ box-shadow:0 0 10px red }
  to{ box-shadow:0 0 30px red }
}

.flash{
  position:fixed;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  background:#28a745;
  color:#fff;
  padding:12px 25px;
  border-radius:30px;
  font-weight:bold;
  animation:fade 2s forwards;
}
@keyframes fade{
  0%{opacity:0}
  20%{opacity:1}
  80%{opacity:1}
  100%{opacity:0}
}

/* RECAP */
#recap{
  max-width:600px;
  margin:30px auto;
  background:#fff;
  padding:15px;
  border-radius:12px;
}
</style>
</head>

<body>

<div id="social-bar">
  <div class="social-item">
    <img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png">
    <span>YouTube : Siotime</span>
  </div>
  <div class="social-item">
    <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png">
    <span>Twitch : SiotimeLive</span>
  </div>
  <div class="social-item">
    <img src="https://cdn-icons-png.flaticon.com/512/733/733579.png">
    <span>X : @SiotimeCards</span>
  </div>
  <div class="social-item">
    <img src="https://cdn-icons-png.flaticon.com/512/1384/1384063.png">
    <span>Instagram : siotime.cards</span>
  </div>
</div>

<h1>üèà NFL Break ‚Äì Siotime</h1>
<div class="timer" id="timer"></div>
<div id="spotsLeft"></div>

<div class="teams" id="teams"></div>

<h2>‚úÖ R√©cap inscrits</h2>
<div id="recap"></div>

<audio id="sound">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3">
</audio>

<script>
const teams = [
{ name:"Arizona Cardinals", price:10, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/ari.png" },
{ name:"Atlanta Falcons", price:10, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/atl.png" },
{ name:"Baltimore Ravens", price:15, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/bal.png" },
{ name:"Buffalo Bills", price:15, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/buf.png" },
{ name:"Carolina Panthers", price:8, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/car.png" },
{ name:"Chicago Bears", price:10, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/chi.png" },
{ name:"Cincinnati Bengals", price:14, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/cin.png" },
{ name:"Cleveland Browns", price:10, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/cle.png" },
{ name:"Dallas Cowboys", price:18, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/dal.png" },
{ name:"Denver Broncos", price:9, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/den.png" },
{ name:"Detroit Lions", price:12, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/det.png" },
{ name:"Green Bay Packers", price:14, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/gb.png" },
{ name:"Houston Texans", price:9, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/hou.png" },
{ name:"Indianapolis Colts", price:10, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/ind.png" },
{ name:"Jacksonville Jaguars", price:8, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/jax.png" },
{ name:"Kansas City Chiefs", price:20, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/kc.png" },
{ name:"Las Vegas Raiders", price:12, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/lv.png" },
{ name:"Los Angeles Chargers", price:13, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/lac.png" },
{ name:"Los Angeles Rams", price:14, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/lar.png" },
{ name:"Miami Dolphins", price:14, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/mia.png" },
{ name:"Minnesota Vikings", price:12, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/min.png" },
{ name:"New England Patriots", price:11, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/ne.png" },
{ name:"New Orleans Saints", price:11, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/no.png" },
{ name:"New York Giants", price:10, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/nyg.png" },
{ name:"New York Jets", price:12, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/nyj.png" },
{ name:"Philadelphia Eagles", price:16, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/phi.png" },
{ name:"Pittsburgh Steelers", price:14, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/pit.png" },
{ name:"San Francisco 49ers", price:18, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/sf.png" },
{ name:"Seattle Seahawks", price:13, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/sea.png" },
{ name:"Tampa Bay Buccaneers", price:12, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/tb.png" },
{ name:"Tennessee Titans", price:10, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/ten.png" },
{ name:"Washington Commanders", price:9, logo:"https://a.espncdn.com/i/teamlogos/nfl/500/wsh.png" }
];

const teamsDiv=document.getElementById("teams");
const recapDiv=document.getElementById("recap");
const timerDiv=document.getElementById("timer");
const sound=document.getElementById("sound");

function render(taken=[]){
  teamsDiv.innerHTML="";
  const left=teams.length-taken.length;
  document.getElementById("spotsLeft").innerText=
    `üéüÔ∏è ${left} spots restants sur ${teams.length}`;

  teams.forEach(t=>{
    const d=document.createElement("div");
    const isTaken=taken.includes(t.name);
    d.className="team"+(isTaken?" taken":"");
    if(left===1 && !isTaken) d.classList.add("last-spot");

    d.innerHTML=`
      <img src="https://a.espncdn.com/i/teamlogos/nfl/500/${t.logo}">
      <p>${t.name}</p>
      <p class="price">10‚Ç¨</p>
    `;

    if(!isTaken) d.onclick=()=>showForm(t.name,d);
    teamsDiv.appendChild(d);
  });
}

function showForm(team,el){
  if(el.querySelector(".reserve-form")) return;

  const form=document.createElement("div");
  form.className="reserve-form";
  form.innerHTML=`
    <input type="text" placeholder="Pseudo">
    <input type="text" placeholder="R√©seau social">
    <button>R√©server</button>
  `;
  el.appendChild(form);

  form.querySelector("button").onclick=async()=>{
    const inputs=form.querySelectorAll("input");
    const pseudo=inputs[0].value.trim();
    const social=inputs[1].value.trim();
    if(!pseudo||!social) return alert("Remplis les champs");

    try{
      const r=await fetch(ENDPOINT,{
        method:"POST",
        body:JSON.stringify({pseudo,social,team})
      });
      const j=await r.json();
      if(j.status==="ok"){
        el.classList.add("reserved","taken");
        sound.play();
        load();
      }else alert("D√©j√† prise");
    }catch(e){ alert("Erreur r√©seau") }
  };
}

async function load(){
  try{
    const taken=await (await fetch(ENDPOINT+"?mode=taken")).json();
    render(taken);

    const recap=await (await fetch(ENDPOINT+"?mode=recap")).json();
    recapDiv.innerHTML="";
    recap.forEach(r=>{
      recapDiv.innerHTML+=`<div><b>${r.pseudo}</b> ‚Äì ${r.team}</div>`;
    });
  }catch(e){ console.log(e) }
}

function updateTimer(){
  const d=deadline-new Date();
  if(d<=0){ timerDiv.innerText="‚õî Inscriptions ferm√©es"; return }
  const h=Math.floor(d/36e5),
        m=Math.floor(d/6e4%60),
        s=Math.floor(d/1e3%60);
  timerDiv.innerText=`‚è≥ Fin dans ${h}h ${m}m ${s}s`;
}

load();
updateTimer();
setInterval(load,15000);
setInterval(updateTimer,1000);
</script>

</body>
</html>
